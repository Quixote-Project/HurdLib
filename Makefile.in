# @configure_input@
# ***************************************************************************
# (C)Copyright 2003-2009, The Open Hurderos Foundation. All rights reserved.
# ***************************************************************************


# Variable declarations provided by autoconf/configure.
prefix = @prefix@
exec_prefix = @exec_prefix@
CC = @CC@
LDFLAGS = @LDFLAGS@


# Variables local to this Makefile
CFLAGS = @CFLAGS@ @CPPFLAGS@ -Wall -fpic

CSRC =	Buffer.c Fibsequence.c Origin.c String.c Config.c basic-parser.c \
	File.c

LIBNAME = HurdLib
LIBRARY = lib${LIBNAME}.a


# Uncomment the following two lines to enable compilation with memory debug
# support
#
# DMALLOC = -DDMALLOC
# DMALLOC_LIBS = -ldmalloc


#
# Compilation directives.
#
%.o: %.c
	${CC} ${CFLAGS} -c $< -o $@;


#
# Automatic variable definitions.
#
COBJS = ${CSRC:.c=.o}


# Targets
all: ${LIBRARY}

${LIBRARY}: ${COBJS}
	ar r ${LIBRARY} $^;
	ranlib ${LIBRARY};

basic-parser.c: basic-parser.l
	flex -o$@ $?;

tags:
	etags *.{h,c};

clean:
	/bin/rm -f basic-parser.c ${COBJS} *~ TAGS ${LIBRARY};

distclean: clean
	/bin/rm -f config.log config.status Makefile autom4te.cache;


# Source dependencies.
Buffer.o: ${LIBNAME}.h Origin.h Fibsequence.h
Fibsequence.o: ${LIBNAME}.h Origin.h Fibsequence.h
File.o: ${LIBNAME}.h Origin.h Buffer.h File.h
Origin.c: ${LIBNAME}.h Origin.h
String.c: ${LIBNAME}.h Origin.h Buffer.h String.h
Config.c: ${LIBNAME}.h Origin.h Config.h
